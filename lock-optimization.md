
Java在语言上支持了锁的特性，在很多常用类的实现中也使用了锁，对于Java开发者来说就可以很方便的使用这些锁及常用类。但是，随着锁的频繁使用及错用，随之而来的就是程序执行效率变低、应用变的缓慢。为了提高线程对共享数据访问的效率，HotSpot虚拟机从JDK1.5到JDK1.6做了重大改进，提供了很多锁优化技术，包括自旋锁、自适应自旋锁、锁消除、锁粗化、轻量级锁和偏向锁。

## 自旋锁
线程的执行是通过竞争获取处理器的执行时间才执行的。当线程挂起或恢复执行的时，会从用户态转入内核态中完成，这种操作是很消耗时间的，在并发情况下对应用和系统来说都有很大压力。HotSpot虚拟机的开发人员注意到很多应用对共享数据锁定的时间都是很短暂的，为了这短暂的时间而挂起和恢复线程是不值得的。所以，线程并发请求锁的时候，让后来的线程在不放弃处理器执行时间的情况下稍等一下，线程做自旋，自旋期间观察持有锁的线程是否会很快释放锁，这种技术就是所谓的自旋锁。

自旋锁在JDK1.6中是默认开启的，默认自旋次数是10次，可以使用参数-XX:PreBlockSpin修改默认值。虽然，自旋锁避免了线程挂起和恢复的开销，但是它占用了处理器的执行时间，如果锁占用时间很短，自旋锁效果很好，否则会浪费处理器的执行时间，影响应用的整体性能。

## 自适应自旋锁
在JDK1.6中引入了自适应自旋锁，自旋的次数由上一次在同一个锁上自旋的时间和锁持有者的状态来决定。如果上一次同一个锁通过自旋刚刚被获取，并且持有锁的线程正在运行，那么虚拟机认为本次自旋也会成功，将会自旋相对长的时间获取锁。如果同一个锁很少通过自旋成功被获取，那么虚拟机认为本次自旋也会失败，不会执行自旋操作。

## 锁消除

## 锁粗化

## 轻量级锁

## 偏向锁
